% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
%
% LaTeX Documentation Template - Header File
%
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% "THE BEER-WARE LICENSE" (Revision 42):
% Hannes Badertscher (hbaderts@hsr.ch) wrote this file. As long as you retain 
% this notice you can do whatever you want with this stuff. If we meet some day, 
% and you think this stuff is worth it, you can buy me a beer in return. 
% - Hannes Badertscher
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

% % % % % % % % % % % % % %
% Basic document setup

\documentclass[
    11pt,               % font size
    final,
    parskip=half,       % half a line skipped between paragraphs
    twoside,            % two-sided document
    openright,          % chapters start on right pages
    bibliography=totoc, % bibliography in toc
    listof=totoc,       % lof and lot in toc
]{scrreprt}             % koma-script report

% Author and title of document
\author{\Author}
\title{\Title}
\date{\today}

% Load Fonts
\usepackage[T1]{fontenc}                      % Use T1 encoding
\usepackage[scaled=0.85]{berasans}            % Sans-serif: Bera Sans
\usepackage[scaled=0.84]{beramono}            % Mono-space: Bera Mono
\usepackage[sc]{mathpazo}                     % Serif: Palatino
\usepackage[T1,small,euler-digits]{eulervm}   % Math: EulerVM
\linespread{1.05}                             % More linespread for Palatino

% Calculate page sizes with 10mm binding offset
\typearea[10mm]{calc}

% Basic packages
\usepackage[final]{microtype}    % Enable micro-typography
\usepackage{scrhack}             % Fixes koma-script incompatibilities
\usepackage{mparhack}            % Improved marginpar placement

% Load HSR colors
\usepackage{xcolor}
\usepackage{header/HSRColors}

% Header and footer
\usepackage[komastyle,automark]{scrpage2}  % Custom header and footer
\pagestyle{scrheadings}
\renewcommand{\headfont}{\normalfont\sffamily}
\makeatletter
    \renewcommand{\chaptermark}[1]{\markboth{\@chapapp~\thechapter~--~#1}{}}
\makeatother
\setheadsepline[text]{0.4pt}
\rohead{\rightmark}
\lehead{\leftmark}

% Bibliography
\usepackage[backend=biber,style=ieee]{biblatex}
\bibliography{frontmatter/bibliograpy.bib}

% Index
\usepackage{imakeidx}
\makeindex[intoc,columnseprule]
\indexsetup{firstpagestyle=plain}    % Show header/footer on index page

% % % % % % % % % % % % % %
% Language stuff
\newcommand*{\LangDE}{de}
\ifx \Lang \LangDE
    \usepackage[english,ngerman]{babel}  % Main language: German
\else
    \usepackage[ngerman,english]{babel}  % Main language: English
\fi

\addto\extrasenglish{% English
    \renewcommand*{\figureautorefname}{Fig.}             % fig:
    \renewcommand*{\tableautorefname}{Tab.}              % tab:
    \renewcommand*{\equationautorefname}{Eq.}            % eq:
}
\addto\extrasngerman{% German
    \renewcommand*{\figureautorefname}{Abb.}             % fig:
    \renewcommand*{\tableautorefname}{Tab.}              % tab:
    \renewcommand*{\equationautorefname}{Gl.}            % eq:
}

% % % % % % % % % % % % % %
% Additional packages

% Date and time format
\usepackage{datetime}
\newdateformat{titledate}{\THEDAY.~\monthname\space\THEYEAR}

% Allow multicolumn document
\usepackage{multicol}

% Math
\usepackage{amsmath}
\usepackage{amssymb}

% Tables
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{booktabs}

% Figures
\usepackage{pdfpages}
\usepackage{epstopdf}

% Listings
\input{header/listings}
\usepackage{matlab-prettifier}

% SI Units
\usepackage{siunitx}
\sisetup{detect-all,sticky-per,per-mode=symbol}

% Glossary
\usepackage[toc]{glossaries}
\renewcommand{\glsnamefont}[1]{\makefirstuc{#1}}

% Quotation marks
\usepackage{csquotes}
\setquotestyle[quotes]{german}

% % % % % % % % % % % % % %
% Numbering and captions
\numberwithin{equation}{chapter}
\numberwithin{figure}{chapter}
\numberwithin{table}{chapter}

% Setup captions
\usepackage{caption}[2008/08/24]
\usepackage{subcaption}
\setkomafont{captionlabel}{\scshape\color{HSRBlue}}
\captionsetup{labelsep=quad}

% Setup toc and section numbering depth
\setcounter{tocdepth}{2}
\setcounter{secnumdepth}{4}

% % % % % % % % % % % % % %
% Hyperref setup
\usepackage[
    pdftitle={\Title},
    pdfauthor={\Author},
    pdfsubject={\Subject},
    pdfkeywords={\Keywords},
    pdflang={\Lang},
    pdfpagemode=UseOutlines,  % Show outlines when opening pdf.
    pdfdisplaydoctitle=true,  % Show document title in pdf viewer.
    pdfcreator={LaTeX with hyperref and KOMA-Script},
    colorlinks=true,
    linkcolor=HSRBlue,
    citecolor=HSRBlue,
    filecolor=HSRBlue,
    urlcolor=HSRBlue,
    bookmarksnumbered=true
]{hyperref}

% If \Print=true, then make all links black for nicer print
\providecommand*{\True}{true}
\ifx \Print \True
    \hypersetup{hidelinks}
\fi


% % % % % % % % % % % % % %
% Marginpar setup
\newcommand*{\oldmarginpar}{}
\let\oldmarginpar\marginpar
\renewcommand*{\marginpar}[1]{\leavevmode\oldmarginpar{{\scshape\normalsize\textcolor{HSRBlue}{#1}}}}

% % % % % % % % % % % % % %
% Itemize items
\newcommand{\hsrlistitemi}{\textcolor{HSRBlue}{\raisebox{.3ex}{\tiny$\blacksquare$}}}
\newcommand{\hsrlistitemii}{\textcolor{HSRLightGray}{\raisebox{.3ex}{\tiny$\blacksquare$}}}
\newcommand{\hsrlistitemiii}{\textcolor{HSRLightGray}{\raisebox{.3ex}{\tiny$\blacktriangleright$}}}

\renewcommand{\labelitemi}{\hsrlistitemi}
\renewcommand{\labelitemii}{\hsrlistitemii}
\renewcommand{\labelitemiii}{\hsrlistitemiii}

% % % % % % % % % % % % % %
% Chapter headings
\makeatletter
\renewcommand{\@makechapterhead}[1]{
    \vspace*{40\p@}
    \hfill
    \begin{minipage}[b]{9cm}
        \raggedleft
        \sffamily\huge\textbf{#1}
    \end{minipage}
    \quad
    \sffamily\fontsize{60pt}{3em}\textcolor{HSRBlue}{\textbf{\thechapter}}
    \vskip 20\p@
    \normalfont\normalsize
}

\renewcommand{\@makeschapterhead}[1]{
    \vspace*{40\p@}
    \hfill
    \begin{minipage}[b]{9cm}
        \raggedleft
        \sffamily\huge\textbf{#1}
    \end{minipage}
    \vskip 20\p@
    \normalfont\normalsize
}
\makeatother

% % % % % % % % % % % % % %
% Appendix page + toc entry
\usepackage{appendix}

\makeatletter
\renewcommand{\@chap@pppage}{%
    \clear@ppage
    \thispagestyle{empty} % this was 'plain' before
    \if@twocolumn\onecolumn\@tempswatrue\else\@tempswafalse\fi
    \null\vfil
    \markboth{}{}%
    {%
        \centering
        \interlinepenalty \@M
        \normalfont
        \Huge \bfseries\sffamily \appendixpagename\par % this was rmfamily
    }%
    \if@dotoc@pp
        \addappheadtotoc
    \fi
    \vfil\newpage
    \if@twoside
        \if@openright
            \null
            \thispagestyle{empty}%
            \newpage
        \fi
    \fi
    \if@tempswa
        \twocolumn
    \fi
}
\makeatother

% % % % % % % % % % % % % %
% TikZ and PGF Plots

\usepackage{tikz}
\usetikzlibrary{positioning}
\usepackage[american currents]{circuitikz}
\usepackage{tikz-timing}[2009/12/09]
\usepackage{pgfplots}

\tikzset{font=\sffamily}  % Use Sans-Serif family in TikZ graphics

% Create cycle list with HSR colors
\pgfplotscreateplotcyclelist{hsrcolorlist}{%
    HSRSchwarz,every mark/.append style={solid,fill=HSRSchwarz}     \\%
    HSRBlue,every mark/.append style={solid,fill=HSRBlue}           \\%
    HSRHematite,every mark/.append style={solid,fill=HSRHematite}   \\%
    HSRBasswood,every mark/.append style={solid,fill=HSRBasswood}   \\%
}
% Set default cycle list for plots
\pgfplotsset{cycle multi list={mark list\nextlist hsrcolorlist}}

% Set default cycle list for bar plots
\pgfplotsset{
    /pgfplots/bar cycle list/.style={/pgfplots/cycle list={%
        {HSRBlue,fill=HSRBlue60,mark=none},%
        {HSRHematite,fill=HSRHematite60,mark=none},%
        {HSRBasswood,fill=HSRBasswood60,mark=none},%
    }}
}

% % % % % % % % % % % % % %
% ToDo notes
\newcommand{\todonotecolor}{red}
\newcommand{\todo}[1]{%
    \marginpar{\textcolor{\todonotecolor}{ToDo}}%
    \colorbox{red}{\parbox{\linewidth}{\textcolor{white}{#1}}}%
    \PackageWarning{ToDo:}{#1!}%
}